---
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-config
  labels:
    chart: "{{ .Chart.Name }}-{{ .Chart.Version }}"
    heritage: {{ .Release.Service | quote }}
    release: {{ .Release.Name | quote }}
    name: {{ .Release.Name }}-config
data:
  operator_config.yaml: |-
    type:
      apiVersion: controller-runtime.sigs.k8s.io/v1alpha1
      kind: ControllerManagerConfig
    manager:
      health:
        healthProbeBindAddress: {{ .Values.manager.health.healthProbeBindAddress }}
      metrics:
        bindAddress: 127.0.0.1:{{ .Values.metrics.service.port }}
      webhook:
        port: {{ .Values.manager.webhook.port }}
      leaderElection:
        leaderElect: {{ .Values.manager.leaderElection.leaderElect }}
        resourceName: eck-custom-resources.xco-sk.github.com
    
    elasticsearch:
      url: {{ .Values.elasticsearch.url }}
      certificate:
        secretName: {{ .Values.elasticsearch.certificate.secretName }}
        certificateKey: {{ .Values.elasticsearch.certificate.certificateKey }}
      authentication:
        usernamePasswordSecret:
          secretName: {{ .Values.elasticsearch.authentication.usernamePasswordSecret.secretName }}
          userName: {{ .Values.elasticsearch.authentication.usernamePasswordSecret.userName }}
